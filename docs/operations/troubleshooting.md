# Troubleshooting - WifiGuard

## Типовые проблемы и решения

### 1. Приложение не видит Wi-Fi сети

**Симптом**: Список сетей пуст или отображается сообщение "Сети не найдены"

**Возможные причины и решения**:
1. **Разрешения не предоставлены**:
   - Проверьте, что разрешение на местоположение предоставлено
   - Перейдите в настройки приложения → Разрешения → Местоположение → Разрешить

2. **Wi-Fi отключен на устройстве**:
   - Убедитесь, что Wi-Fi включен в системных настройках
   - Проверьте, что функция Airplane Mode отключена

3. **Android 6+ требование местоположения**:
   - Android требует разрешение местоположения для сканирования Wi-Fi
   - Даже если данные местоположения не используются, разрешение обязательно

4. **Проблемы с API 33+ (Android 13)**:
   - Убедитесь, что разрешение "NEARBY_WIFI_DEVICES" предоставлено
   - Проверьте, что включено в настройках приложения

### 2. Нет уведомлений об угрозах

**Симптом**: Приложение не отправляет уведомления при подключении к небезопасным сетям

**Возможные причины и решения**:
1. **Разрешение на уведомления не предоставлено**:
   - Проверьте системные настройки уведомлений для приложения
   - Android 13+ требует явное разрешение на уведомления

2. **Фоновый мониторинг отключен**:
   - Проверьте настройки → "Автоматическое сканирование"
   - Убедитесь, что включены уведомления в настройках

3. **Ограничения фоновой активности**:
   - Некоторые производители (Xiaomi, Huawei, OnePlus) имеют агрессивные настройки батареи
   - Добавьте приложение в список исключений энергосбережения

4. **Служба WorkManager остановлена**:
   - Перезапустите приложение
   - Проверьте, что приложение не находится в списке "оптимизированных" приложений

### 3. Приложение не запускается или падает

**Симптом**: Приложение вылетает при запуске или не открывается

**Возможные причины и решения**:
1. **Конфликты с предыдущими версиями**:
   - Удалите предыдущую версию и установите заново
   - Очистите данные приложения: Настройки → Приложения → WifiGuard → Хранилище → Очистить данные

2. **Недостаточно прав доступа**:
   - Убедитесь, что все разрешения предоставлены
   - Особенно критичны: местоположение, Wi-Fi, уведомления

3. **Проблемы с API**:
   - Проверьте, что используется поддерживаемая версия Android (API 26+)
   - Убедитесь, что устройство поддерживает Wi-Fi

4. **Проблемы с зависимостями**:
   - Попробуйте перезапустить устройство
   - Убедитесь, что достаточно свободного места

### 4. Неверная оценка безопасности сети

**Симптом**: Сеть отображается как безопасная, но на самом деле небезопасная (или наоборот)

**Возможные причины и решения**:
1. **Устаревший алгоритм анализа**:
   - Убедитесь, что используется последняя версия приложения
   - Обновите приложение через Google Play или установите новую APK

2. **Нет доступа к полной информации о сети**:
   - Проверьте, что все разрешения предоставлены
   - Перезапустите приложение после предоставления разрешений

3. **Ограничения Android API**:
   - Некоторые данные о безопасности могут быть ограничены Android API
   - Применяются только публично доступные данные

4. **Проблемы с конкретным типом шифрования**:
   - Сообщите о проблеме через GitHub Issues
   - Укажите SSID сети и тип шифрования для анализа

### 5. Высокое потребление батареи

**Симптом**: Приложение быстро разряжает батарею устройства

**Возможные причины и решения**:
1. **Частое автоматическое сканирование**:
   - Увеличьте интервал сканирования в настройках
   - Установите интервал на 30 минут или 1 час вместо 5 минут

2. **Фоновый мониторинг**:
   - Отключите автоматическое сканирование, если не требуется
   - Используйте только ручное сканирование

3. **WorkManager задачи**:
   - Проверьте, что задачи не запускаются слишком часто
   - Убедитесь, что задачи корректно завершаются

4. **Фоновые службы**:
   - Android 14+ требует Foreground Service для мониторинга местоположения
   - Это может увеличивать потребление батареи

## Диагностика и логи

### Проверка состояния приложения

Для диагностики проблем можно использовать следующие команды ADB:

```bash
# Проверить разрешения приложения
adb shell dumpsys package com.wifiguard | grep permission

# Проверить статус WorkManager задач
adb shell am broadcast -n com.wifiguard/.core.background.DebugReceiver

# Посмотреть последние логи приложения
adb logcat -s "WifiGuard*" | tail -50
```

### Проверка базы данных

Если есть подозрения на проблемы с данными:

```bash
# Проверить наличие базы данных
adb shell run-as com.wifiguard ls databases/

# Экспортировать базу данных (для разработчиков)
adb shell run-as com.wifiguard cat databases/wifiguard_database > local_backup.db
```

## Ограничения и особенности

### Ограничения Android API
- Начиная с Android 10, фоновые приложения не могут сканировать Wi-Fi без Foreground Service
- Android 13+ вводит новые разрешения (NEARBY_WIFI_DEVICES)
- Некоторые OEM-производители (Samsung, Huawei и др.) имеют дополнительные ограничения

### Совместимость
- Минимальная версия Android: 8.0 (API 26)
- Требуется наличие Wi-Fi оборудования
- Рекомендуется Android 11+ для полной функциональности

### Производительность
- Сканирование может замедлить другие сетевые операции
- Частое сканирование влияет на производительность
- Рекомендуется использовать интервал 15+ минут

## Как сообщить о проблеме

При возникновении нерешаемой проблемы:

1. **Соберите информацию**:
   - Версия Android устройства
   - Модель устройства
   - Версия приложения
   - Описание проблемы
   - Шаги для воспроизведения

2. **Соберите логи**:
   ```bash
   adb logcat -s "WifiGuard*" > wifiguard_logs.txt
   ```

3. **Создайте Issue**:
   - Откройте репозиторий на GitHub
   - Создайте новый Issue с описанием проблемы
   - Приложите собранные логи и информацию

## Системные требования

- Android 8.0 (API 26) или выше
- Поддержка Wi-Fi (наличие в устройстве)
- Разрешения: местоположение, Wi-Fi, уведомления
- Рекомендуется 100+ МБ свободного места

## Сброс настроек

Если приложение ведет себя некорректно:

1. Закройте приложение
2. Перейдите в системные настройки → Приложения → WifiGuard
3. Нажмите "Очистить данные" и "Очистить кэш"
4. Перезапустите приложение
5. Предоставьте все разрешения заново