#!/bin/bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é "—Å–µ–≥–æ–¥–Ω—è —É—Ç—Ä–æ–º" (–¥–æ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å GitHub)

echo "üïê –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é —Å–µ–≥–æ–¥–Ω—è —É—Ç—Ä–æ–º..."
echo ""

# –ö–æ–º–º–∏—Ç —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –¥–æ –≤—Å–µ—Ö merge/rebase –æ–ø–µ—Ä–∞—Ü–∏–π
MORNING_COMMIT="5974b116c6d76c283908e107f1042ed856a0d0ed"

echo "üìã –ù–∞–π–¥–µ–Ω–Ω—ã–π –∫–æ–º–º–∏—Ç: $MORNING_COMMIT"
echo "   –°–æ–æ–±—â–µ–Ω–∏–µ: '–ù–∞—á–∞–ª—å–Ω—ã–π –∫–æ–º–º–∏—Ç –ø—Ä–æ–µ–∫—Ç–∞ WifiGuard'"
echo "   –í—Ä–µ–º—è: –¥–æ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å GitHub"
echo ""

echo "‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ main!"
echo "   –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º."
echo ""

read -p "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (y/n) " -n 1 -r
echo ""

if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    echo "‚ùå –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ"
    exit 1
fi

echo ""
echo "1Ô∏è‚É£  –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è..."
git branch backup-before-restore-$(date +%Y%m%d-%H%M%S)

echo ""
echo "2Ô∏è‚É£  –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∫–æ–º–º–∏—Ç–∞..."
git show $MORNING_COMMIT --stat | head -30

echo ""
echo "3Ô∏è‚É£  –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é —É—Ç—Ä–∞..."
git reset --hard $MORNING_COMMIT

echo ""
echo "‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
echo ""
echo "üìù –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:"
git log --oneline -3

echo ""
echo "üîÑ –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ GitHub (–ü–ï–†–ï–ó–ê–ü–ò–°–ï–¢ —É–¥–∞–ª–µ–Ω–Ω—É—é –≤–µ—Ç–∫—É):"
echo "   git push origin main --force"
echo ""
echo "‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: --force –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç —É–¥–∞–ª–µ–Ω–Ω—É—é –≤–µ—Ç–∫—É!"
echo "   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π."
